<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Express â€¢ Appointment Scheduling</title>
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/app.css">
</head>
<body>
    <section class="todoapp">
        <nav class="nav">
            <ul>
                <li class="user"><%= user.name || user.username || user.email %></li>
                <li>
                    <form action="/logout" method="post">
                        <button class="logout" type="submit">Sign out</button>
                    </form>
                </li>
            </ul>
        </nav
        <header class="header">
            <h1>Appointments</h1>
            <form action="/add-appointment" method="post">
                <input class="new-appointment-date" name="appointDate" placeholder="Date" type="date" required>
                <input class="new-appointment-start" name="startTime" placeholder="Start Time" type="time" required>
                <input class="new-appointment-end" name="endTime" placeholder="End Time" type="time" required>
                <input type="submit" value="Add">
            </form>
        </header>
        <% if (appointments.length > 0) { %>
        <section class="main">
            <ul class="appointment-list">
                <% appointments.forEach(function(appointment) { %>
                <li class="<%= appointment.status %>">
                    <div class="view">
                        <label><%= appointment.time %></label>
                        <% if (appointment.status === 'active') { %>
                        <form action="/appointments/<%= appointment.id %>/cancel" method="post">
                            <button class="cancel">Cancel</button>
                        </form>
                        <% } %>
                        <% if (appointment.status === 'completed') { %>
                        <span>Completed</span>
                        <% } %>
                        <% if (appointment.status === 'cancelled') { %>
                        <span>Cancelled</span>
                        <% } %>
                    </div>
                </li>
                <% }); %>
            </ul>
        </section>
        <% } %>
        <footer class="footer">
            <span class="appointment-count"><strong><%= appointments.filter(a => a.status === 'active').length %></strong> appointments left</span>
            <ul class="filters">
                <li>
                    <a <%- !filter || filter == 'all' ? 'class="selected"' : '' %> href="/appointments/all">All</a>
                </li>
                <li>
                    <a <%- filter == 'active' ? 'class="selected"' : '' %> href="/appointments/active">Active</a>
                </li>
                <li>
                    <a <%- filter == 'completed' ? 'class="selected"' : '' %> href="/appointments/completed">Completed</a>
                </li>
                <li>
                    <a <%- filter == 'cancelled' ? 'class="selected"' : '' %> href="/appointments/cancelled">Cancelled</a>
                </li>
            </ul>
        </footer>
    </section>
    <footer class="info">
        <p>Click to edit an appointment</p>
        <p>Created by <a href="https://www.jaredhanson.me">Jared Hanson</a></p>
        <p>Part of <a href="https://todomvc.com">TodoMVC</a></p>
        <p>Authentication powered by <a href="https://www.passportjs.org">Passport</a></p>
    </footer>
</body>
</html>
